"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=D%3A%5CNeuroLearn%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CNeuroLearn&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=D%3A%5CNeuroLearn%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CNeuroLearn&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_NeuroLearn_src_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/chat/route.ts */ \"(rsc)/./src/app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"D:\\\\NeuroLearn\\\\src\\\\app\\\\api\\\\chat\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_NeuroLearn_src_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDTmV1cm9MZWFybiU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RCUzQSU1Q05ldXJvTGVhcm4maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ0g7QUFDMUU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXVyb2xlYXJuLz9lYWU4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkQ6XFxcXE5ldXJvTGVhcm5cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcY2hhdFxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2hhdC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NoYXRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NoYXQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxOZXVyb0xlYXJuXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGNoYXRcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2NoYXQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=D%3A%5CNeuroLearn%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CNeuroLearn&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/chat/route.ts":
/*!***********************************!*\
  !*** ./src/app/api/chat/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n\n\nconst genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__.GoogleGenerativeAI(process.env.GOOGLE_API_KEY);\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://cgryfltmvaplsrawoktj.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\nasync function POST(request) {\n    try {\n        console.log(\"Chat API called\");\n        const { message, notebookId, conversationHistory = [] } = await request.json();\n        console.log(\"Request parsed:\", {\n            message,\n            notebookId\n        });\n        if (!message) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Message is required\"\n            }, {\n                status: 400\n            });\n        }\n        // Check if GOOGLE_API_KEY exists\n        if (!process.env.GOOGLE_API_KEY) {\n            console.error(\"GOOGLE_API_KEY is missing\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Google API key not configured\"\n            }, {\n                status: 500\n            });\n        }\n        console.log(\"Google API key found\");\n        // Get relevant documents from the notebook if specified\n        let contextDocuments = [];\n        let sources = [];\n        if (notebookId) {\n            console.log(\"Querying database for notebookId:\", notebookId);\n            // Validate UUID format\n            const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n            if (!uuidRegex.test(notebookId)) {\n                console.log(\"Invalid UUID format for notebookId:\", notebookId);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Invalid notebook ID format\"\n                }, {\n                    status: 400\n                });\n            }\n            try {\n                // First get the file IDs from notebook_files\n                const { data: notebookFiles, error: notebookError } = await supabase.from(\"notebook_files\").select(\"file_id\").eq(\"notebook_id\", notebookId);\n                console.log(\"Notebook files query result:\", {\n                    notebookFiles,\n                    notebookError\n                });\n                if (notebookError) {\n                    console.error(\"Notebook files query error:\", notebookError);\n                    throw new Error(`Notebook files query failed: ${notebookError.message}`);\n                }\n                if (notebookFiles && notebookFiles.length > 0) {\n                    const fileIds = notebookFiles.map((nf)=>nf.file_id);\n                    console.log(\"File IDs:\", fileIds);\n                    // Then get the actual files\n                    const { data: files, error: filesError } = await supabase.from(\"files\").select(\"id, filename, content\").in(\"id\", fileIds);\n                    console.log(\"Files query result:\", {\n                        files,\n                        filesError\n                    });\n                    if (filesError) {\n                        console.error(\"Files query error:\", filesError);\n                        throw new Error(`Files query failed: ${filesError.message}`);\n                    }\n                    if (files && files.length > 0) {\n                        contextDocuments = files;\n                        sources = files.map((doc)=>doc.filename);\n                    }\n                }\n            } catch (dbError) {\n                console.error(\"Database query exception:\", dbError);\n                throw dbError;\n            }\n        }\n        // Prepare context for RAG\n        const contextText = contextDocuments.map((doc)=>`Document: ${doc.filename}\\nContent: ${doc.content}`).join(\"\\n\\n\");\n        // Build conversation history for context\n        const conversationContext = conversationHistory.slice(-5) // Keep last 5 messages for context\n        .map((msg)=>`${msg.role}: ${msg.content}`).join(\"\\n\");\n        // Create the prompt with RAG context\n        const prompt = `You are an AI assistant helping with document analysis and learning. Use the provided documents to answer questions accurately and cite your sources.\n\n${contextText ? `Available Documents:\\n${contextText}\\n\\n` : \"\"}\n${conversationContext ? `Previous Conversation:\\n${conversationContext}\\n\\n` : \"\"}\nUser Question: ${message}\n\nPlease provide a helpful response based on the available documents. If you reference specific information from a document, mention which document it came from.`;\n        // Generate response using Gemini\n        const model = genAI.getGenerativeModel({\n            model: \"gemini-1.5-flash\"\n        });\n        const result = await model.generateContent(prompt);\n        const response = await result.response;\n        const text = response.text();\n        // Save the conversation to database if notebook is specified\n        if (notebookId) {\n            try {\n                // Save user message\n                await supabase.from(\"conversations\").insert({\n                    notebook_id: notebookId,\n                    message: message,\n                    role: \"user\"\n                });\n                // Save assistant message\n                await supabase.from(\"conversations\").insert({\n                    notebook_id: notebookId,\n                    message: text,\n                    role: \"assistant\"\n                });\n            } catch (saveError) {\n                console.error(\"Error saving conversation:\", saveError);\n            // Don't throw here, just log the error\n            }\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: text,\n            sources: sources.length > 0 ? sources : undefined,\n            timestamp: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"Chat API error:\", error);\n        console.error(\"Error details:\", {\n            message: error instanceof Error ? error.message : \"Unknown error\",\n            stack: error instanceof Error ? error.stack : \"No stack trace\",\n            name: error instanceof Error ? error.name : \"Unknown\"\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to process chat message\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET() {\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        message: \"Chat API is running\"\n    }, {\n        status: 200\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgR29vZ2xlR2VuZXJhdGl2ZUFJIH0gZnJvbSAnQGdvb2dsZS9nZW5lcmF0aXZlLWFpJztcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5cbmNvbnN0IGdlbkFJID0gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSShwcm9jZXNzLmVudi5HT09HTEVfQVBJX0tFWSEpO1xuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkhXG4pO1xuXG5pbnRlcmZhY2UgQ2hhdE1lc3NhZ2Uge1xuICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgY29udGVudDogc3RyaW5nO1xuICBzb3VyY2VzPzogc3RyaW5nW107XG59XG5cbmludGVyZmFjZSBDaGF0UmVxdWVzdCB7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgbm90ZWJvb2tJZD86IHN0cmluZztcbiAgY29udmVyc2F0aW9uSGlzdG9yeT86IENoYXRNZXNzYWdlW107XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ0NoYXQgQVBJIGNhbGxlZCcpO1xuICAgIGNvbnN0IHsgbWVzc2FnZSwgbm90ZWJvb2tJZCwgY29udmVyc2F0aW9uSGlzdG9yeSA9IFtdIH06IENoYXRSZXF1ZXN0ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc29sZS5sb2coJ1JlcXVlc3QgcGFyc2VkOicsIHsgbWVzc2FnZSwgbm90ZWJvb2tJZCB9KTtcblxuICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnTWVzc2FnZSBpcyByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIEdPT0dMRV9BUElfS0VZIGV4aXN0c1xuICAgIGlmICghcHJvY2Vzcy5lbnYuR09PR0xFX0FQSV9LRVkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0dPT0dMRV9BUElfS0VZIGlzIG1pc3NpbmcnKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0dvb2dsZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKCdHb29nbGUgQVBJIGtleSBmb3VuZCcpO1xuXG4gICAgLy8gR2V0IHJlbGV2YW50IGRvY3VtZW50cyBmcm9tIHRoZSBub3RlYm9vayBpZiBzcGVjaWZpZWRcbiAgICBsZXQgY29udGV4dERvY3VtZW50czogYW55W10gPSBbXTtcbiAgICBsZXQgc291cmNlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChub3RlYm9va0lkKSB7XG4gICAgICBjb25zb2xlLmxvZygnUXVlcnlpbmcgZGF0YWJhc2UgZm9yIG5vdGVib29rSWQ6Jywgbm90ZWJvb2tJZCk7XG4gICAgICBcbiAgICAgIC8vIFZhbGlkYXRlIFVVSUQgZm9ybWF0XG4gICAgICBjb25zdCB1dWlkUmVnZXggPSAvXlswLTlhLWZdezh9LVswLTlhLWZdezR9LVsxLTVdWzAtOWEtZl17M30tWzg5YWJdWzAtOWEtZl17M30tWzAtOWEtZl17MTJ9JC9pO1xuICAgICAgaWYgKCF1dWlkUmVnZXgudGVzdChub3RlYm9va0lkKSkge1xuICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCBVVUlEIGZvcm1hdCBmb3Igbm90ZWJvb2tJZDonLCBub3RlYm9va0lkKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgZXJyb3I6ICdJbnZhbGlkIG5vdGVib29rIElEIGZvcm1hdCcgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIEZpcnN0IGdldCB0aGUgZmlsZSBJRHMgZnJvbSBub3RlYm9va19maWxlc1xuICAgICAgICBjb25zdCB7IGRhdGE6IG5vdGVib29rRmlsZXMsIGVycm9yOiBub3RlYm9va0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKCdub3RlYm9va19maWxlcycpXG4gICAgICAgICAgLnNlbGVjdCgnZmlsZV9pZCcpXG4gICAgICAgICAgLmVxKCdub3RlYm9va19pZCcsIG5vdGVib29rSWQpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdOb3RlYm9vayBmaWxlcyBxdWVyeSByZXN1bHQ6JywgeyBub3RlYm9va0ZpbGVzLCBub3RlYm9va0Vycm9yIH0pO1xuXG4gICAgICAgIGlmIChub3RlYm9va0Vycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignTm90ZWJvb2sgZmlsZXMgcXVlcnkgZXJyb3I6Jywgbm90ZWJvb2tFcnJvcik7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBOb3RlYm9vayBmaWxlcyBxdWVyeSBmYWlsZWQ6ICR7bm90ZWJvb2tFcnJvci5tZXNzYWdlfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5vdGVib29rRmlsZXMgJiYgbm90ZWJvb2tGaWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgZmlsZUlkcyA9IG5vdGVib29rRmlsZXMubWFwKG5mID0+IG5mLmZpbGVfaWQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdGaWxlIElEczonLCBmaWxlSWRzKTtcblxuICAgICAgICAgIC8vIFRoZW4gZ2V0IHRoZSBhY3R1YWwgZmlsZXNcbiAgICAgICAgICBjb25zdCB7IGRhdGE6IGZpbGVzLCBlcnJvcjogZmlsZXNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgIC5mcm9tKCdmaWxlcycpXG4gICAgICAgICAgICAuc2VsZWN0KCdpZCwgZmlsZW5hbWUsIGNvbnRlbnQnKVxuICAgICAgICAgICAgLmluKCdpZCcsIGZpbGVJZHMpO1xuXG4gICAgICAgICAgY29uc29sZS5sb2coJ0ZpbGVzIHF1ZXJ5IHJlc3VsdDonLCB7IGZpbGVzLCBmaWxlc0Vycm9yIH0pO1xuXG4gICAgICAgICAgaWYgKGZpbGVzRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZpbGVzIHF1ZXJ5IGVycm9yOicsIGZpbGVzRXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlcyBxdWVyeSBmYWlsZWQ6ICR7ZmlsZXNFcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0RG9jdW1lbnRzID0gZmlsZXM7XG4gICAgICAgICAgICBzb3VyY2VzID0gZmlsZXMubWFwKGRvYyA9PiBkb2MuZmlsZW5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZGJFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBxdWVyeSBleGNlcHRpb246JywgZGJFcnJvcik7XG4gICAgICAgIHRocm93IGRiRXJyb3I7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUHJlcGFyZSBjb250ZXh0IGZvciBSQUdcbiAgICBjb25zdCBjb250ZXh0VGV4dCA9IGNvbnRleHREb2N1bWVudHNcbiAgICAgIC5tYXAoZG9jID0+IGBEb2N1bWVudDogJHtkb2MuZmlsZW5hbWV9XFxuQ29udGVudDogJHtkb2MuY29udGVudH1gKVxuICAgICAgLmpvaW4oJ1xcblxcbicpO1xuXG4gICAgLy8gQnVpbGQgY29udmVyc2F0aW9uIGhpc3RvcnkgZm9yIGNvbnRleHRcbiAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gY29udmVyc2F0aW9uSGlzdG9yeVxuICAgICAgLnNsaWNlKC01KSAvLyBLZWVwIGxhc3QgNSBtZXNzYWdlcyBmb3IgY29udGV4dFxuICAgICAgLm1hcChtc2cgPT4gYCR7bXNnLnJvbGV9OiAke21zZy5jb250ZW50fWApXG4gICAgICAuam9pbignXFxuJyk7XG5cbiAgICAvLyBDcmVhdGUgdGhlIHByb21wdCB3aXRoIFJBRyBjb250ZXh0XG4gICAgY29uc3QgcHJvbXB0ID0gYFlvdSBhcmUgYW4gQUkgYXNzaXN0YW50IGhlbHBpbmcgd2l0aCBkb2N1bWVudCBhbmFseXNpcyBhbmQgbGVhcm5pbmcuIFVzZSB0aGUgcHJvdmlkZWQgZG9jdW1lbnRzIHRvIGFuc3dlciBxdWVzdGlvbnMgYWNjdXJhdGVseSBhbmQgY2l0ZSB5b3VyIHNvdXJjZXMuXG5cbiR7Y29udGV4dFRleHQgPyBgQXZhaWxhYmxlIERvY3VtZW50czpcXG4ke2NvbnRleHRUZXh0fVxcblxcbmAgOiAnJ31cbiR7Y29udmVyc2F0aW9uQ29udGV4dCA/IGBQcmV2aW91cyBDb252ZXJzYXRpb246XFxuJHtjb252ZXJzYXRpb25Db250ZXh0fVxcblxcbmAgOiAnJ31cblVzZXIgUXVlc3Rpb246ICR7bWVzc2FnZX1cblxuUGxlYXNlIHByb3ZpZGUgYSBoZWxwZnVsIHJlc3BvbnNlIGJhc2VkIG9uIHRoZSBhdmFpbGFibGUgZG9jdW1lbnRzLiBJZiB5b3UgcmVmZXJlbmNlIHNwZWNpZmljIGluZm9ybWF0aW9uIGZyb20gYSBkb2N1bWVudCwgbWVudGlvbiB3aGljaCBkb2N1bWVudCBpdCBjYW1lIGZyb20uYDtcblxuICAgIC8vIEdlbmVyYXRlIHJlc3BvbnNlIHVzaW5nIEdlbWluaVxuICAgIGNvbnN0IG1vZGVsID0gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6ICdnZW1pbmktMS41LWZsYXNoJyB9KTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2RlbC5nZW5lcmF0ZUNvbnRlbnQocHJvbXB0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlc3VsdC5yZXNwb25zZTtcbiAgICBjb25zdCB0ZXh0ID0gcmVzcG9uc2UudGV4dCgpO1xuXG4gICAgLy8gU2F2ZSB0aGUgY29udmVyc2F0aW9uIHRvIGRhdGFiYXNlIGlmIG5vdGVib29rIGlzIHNwZWNpZmllZFxuICAgIGlmIChub3RlYm9va0lkKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBTYXZlIHVzZXIgbWVzc2FnZVxuICAgICAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKCdjb252ZXJzYXRpb25zJylcbiAgICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICAgIG5vdGVib29rX2lkOiBub3RlYm9va0lkLFxuICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJ1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFNhdmUgYXNzaXN0YW50IG1lc3NhZ2VcbiAgICAgICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAuZnJvbSgnY29udmVyc2F0aW9ucycpXG4gICAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgICBub3RlYm9va19pZDogbm90ZWJvb2tJZCxcbiAgICAgICAgICAgIG1lc3NhZ2U6IHRleHQsXG4gICAgICAgICAgICByb2xlOiAnYXNzaXN0YW50J1xuICAgICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoc2F2ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBjb252ZXJzYXRpb246Jywgc2F2ZUVycm9yKTtcbiAgICAgICAgLy8gRG9uJ3QgdGhyb3cgaGVyZSwganVzdCBsb2cgdGhlIGVycm9yXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIG1lc3NhZ2U6IHRleHQsXG4gICAgICBzb3VyY2VzOiBzb3VyY2VzLmxlbmd0aCA+IDAgPyBzb3VyY2VzIDogdW5kZWZpbmVkLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0NoYXQgQVBJIGVycm9yOicsIGVycm9yKTtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZXRhaWxzOicsIHtcbiAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgc3RhY2s6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6ICdObyBzdGFjayB0cmFjZScsXG4gICAgICBuYW1lOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubmFtZSA6ICdVbmtub3duJ1xuICAgIH0pO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdGYWlsZWQgdG8gcHJvY2VzcyBjaGF0IG1lc3NhZ2UnLCBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKCkge1xuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgeyBtZXNzYWdlOiAnQ2hhdCBBUEkgaXMgcnVubmluZycgfSxcbiAgICB7IHN0YXR1czogMjAwIH1cbiAgKTtcbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiR29vZ2xlR2VuZXJhdGl2ZUFJIiwiY3JlYXRlQ2xpZW50IiwiZ2VuQUkiLCJwcm9jZXNzIiwiZW52IiwiR09PR0xFX0FQSV9LRVkiLCJzdXBhYmFzZSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJQT1NUIiwicmVxdWVzdCIsImNvbnNvbGUiLCJsb2ciLCJtZXNzYWdlIiwibm90ZWJvb2tJZCIsImNvbnZlcnNhdGlvbkhpc3RvcnkiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJjb250ZXh0RG9jdW1lbnRzIiwic291cmNlcyIsInV1aWRSZWdleCIsInRlc3QiLCJkYXRhIiwibm90ZWJvb2tGaWxlcyIsIm5vdGVib29rRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJFcnJvciIsImxlbmd0aCIsImZpbGVJZHMiLCJtYXAiLCJuZiIsImZpbGVfaWQiLCJmaWxlcyIsImZpbGVzRXJyb3IiLCJpbiIsImRvYyIsImZpbGVuYW1lIiwiZGJFcnJvciIsImNvbnRleHRUZXh0IiwiY29udGVudCIsImpvaW4iLCJjb252ZXJzYXRpb25Db250ZXh0Iiwic2xpY2UiLCJtc2ciLCJyb2xlIiwicHJvbXB0IiwibW9kZWwiLCJnZXRHZW5lcmF0aXZlTW9kZWwiLCJyZXN1bHQiLCJnZW5lcmF0ZUNvbnRlbnQiLCJyZXNwb25zZSIsInRleHQiLCJpbnNlcnQiLCJub3RlYm9va19pZCIsInNhdmVFcnJvciIsInVuZGVmaW5lZCIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInN0YWNrIiwibmFtZSIsImRldGFpbHMiLCJHRVQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/chat/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/@google"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=D%3A%5CNeuroLearn%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CNeuroLearn&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();